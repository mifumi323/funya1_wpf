# 未処理例外のエラー画面表示について

## 概要

このアプリケーションでは、未処理の例外が発生した場合にアプリケーションがクラッシュせずに、エラー画面を表示するように実装しています。
.NET Core（.NET 5以降）のWPFアプリケーションでは、未処理例外が発生した場合にエラー画面を表示せずに即座にクラッシュする動作が標準となっていますが、
ユーザーエクスペリエンスを向上させるために、例外をキャッチしてエラー情報を表示する機能を追加しました。

## 実装内容

以下の3種類の未処理例外に対応しています：

1. **UI スレッドでの未処理例外**
   - `Application.DispatcherUnhandledException` イベントをハンドル
   - UI操作中に発生する例外を捕捉

2. **非 UI スレッドでの未処理例外**
   - `AppDomain.CurrentDomain.UnhandledException` イベントをハンドル
   - バックグラウンドスレッドで発生する例外を捕捉

3. **Task 内での未処理例外**
   - `TaskScheduler.UnobservedTaskException` イベントをハンドル
   - 非同期タスク内で発生する例外を捕捉

## エラー処理の流れ

1. 未処理例外が発生
2. 対応するイベントハンドラがキャッチ
3. 例外情報をログファイルに記録（`Logs`フォルダ内）
4. ユーザーにエラーメッセージを表示
5. 可能な場合は、アプリケーションの実行を継続

## テスト機能

例外処理の動作確認のため、以下のテストメニューを「ヘルプ」メニュー内に追加しています：

- **例外テスト** - UI スレッドで例外を発生させる
- **スレッド例外テスト** - 非 UI スレッドで例外を発生させる
- **タスク例外テスト** - Task 内で例外を発生させる

## 参考資料

この実装は以下の記事を参考にしています：
- [WPF アプリケーションで未処理例外をハンドルする](https://zenn.dev/nuits_jp/articles/2023-03-08-wpf-unhandled-exception)